% Copyright 2006 Konstantin Korikov <lostclus@ua.fm>
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2003/12/01 or later.
%
% This work has the LPPL maintenance status "maintained".
% 
% This Current Maintainer of this work is Konstantin Korikov.
%
% This work consists of all files listed in manifest.txt.
%
m4_ESKDX_INIT
m4_FILE_INIT
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{eskdspec}[m4_dnl
m4_FILE_ID([[$Date$]]) Specification GOST 2.106.95]

\RequirePackage{eskdlang}
\RequirePackage{eskdstamp}
\RequirePackage{rotating}
\RequirePackage{array}
\RequirePackage{longtable}

\newcommand{\ESKDspecFontHead}{\ESKDfontTabHead}
\newcommand{\ESKDspecFontBody}{\ESKDfontTabBody}

\newcommand{\ESKDdrawSpecification}{
  \put(\ESKDltu{\ESKDframeX},\ESKDltu{\ESKDframeY}){%
    \begin{picture}(0,0)
    \ESKD@tmpdimb=\ESKDframeH
    \ESKD@tmpdima=\ESKD@style@sh@formII
    \ESKD@tmpdimc=8mm
    \advance\ESKD@tmpdimb -\ESKD@tmpdima
    \advance\ESKD@tmpdimb -15mm
    \divide\ESKD@tmpdimb by \ESKD@tmpdimc
    \ESKD@tmpcnta=\ESKD@tmpdimb
    \ESKD@tmpdimb=\ESKD@tmpdimc
    \multiply\ESKD@tmpdimb by \ESKD@tmpcnta
    \advance\ESKD@tmpdimb 15mm
    \ESKD@tmpdima=\ESKDframeH
    \advance\ESKD@tmpdima -\ESKD@tmpdimb
    \linethickness{\ESKDlineThick}
    \put(6,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}
    \put(12,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}
    \put(20,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}
    \put(90,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}
    \put(153,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}
    \put(163,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}
    \ESKD@tmpdimb=\ESKDframeH
    \advance\ESKD@tmpdimb -15mm
    \put(0,\ESKDltu{\ESKD@tmpdimb}){\line(1,0){\ESKDltu{\ESKDframeW}}}
    \linethickness{\ESKDlineThin}
    \multiput(0,\ESKDltu{\ESKD@tmpdima})(0, 8){\the\ESKD@tmpcnta}{%
      \line(1,0){\ESKDltu{\ESKDframeW}}}
    \end{picture}}}

m4_dnl спецификация
\newenvironment{ESKDspecification}{%
\ESKDputOnStyle{formII}{specification}{\ESKDdrawSpecification}
\ESKDputOnStyle{formIIab}{specification}{\ESKDdrawSpecification}
\begin{ESKDzeroPadding}%
\setlength{\tabcolsep}{0.5mm}%
\setlength{\LTpre}{0mm}%
\setlength{\LTpost}{0mm}%
\setlength{\LTleft}{0mm}%
\setlength{\LTright}{\fill}%
\newcolumntype{s}{>{\ESKDspecFontBody}c}%
\newcolumntype{n}{>{\parbox[c][8mm][c]{1mm}{%
  \rule{0mm}{0mm}}\ESKDspecFontBody}l}%
\noindent%
\begin{longtable}{ssssnss}
\parbox[c][15mm][c]{5mm}{\centering\begin{sideways}\ESKDspecFontHead%
\ESKDspecColumnIname\end{sideways}}&
\parbox[c][15mm][c]{5mm}{\centering\begin{sideways}\ESKDspecFontHead%
\ESKDspecColumnIIname\end{sideways}}&
\parbox[c][15mm][c]{7mm}{\centering\begin{sideways}\ESKDspecFontHead%
\ESKDspecColumnIIIname\end{sideways}}&
\parbox[c][15mm][c]{69mm}{\centering\ESKDspecFontHead%
\ESKDspecColumnIVname}&
\parbox[c][15mm][c]{61mm}{\centering\ESKDspecFontHead%
\ESKDspecColumnVname}&
\parbox[c][15mm][c]{9mm}{\centering\begin{sideways}\ESKDspecFontHead%
\ESKDspecColumnVIname\end{sideways}}&
\parbox[c][15mm][c]{21mm}{\centering\ESKDspecFontHead%
\ESKDspecColumnVIIname}\endhead}{%
\end{longtable}%
\end{ESKDzeroPadding}%
\ESKDremoveFromStyle{formII}{spec}%
\ESKDremoveFromStyle{formIIab}{spec}}

m4_dnl vim:ft=tex:sw=2:ai
